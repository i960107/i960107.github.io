---
title: 네트워크 전체 흐름 살펴보
tags:
- 23년 2월
- 네트워크
author: 수현
---
# 네트워크 전체 흐름 살펴보기

- 웹 사이트에 방문했을때 이루어지는(url을 입력할때부터 웹서버에 도착할때 이루어지는) 전체적인 데이터 처리 과정
1.  **응용계층**에서 ‘GET /index.html HTTP/1.1~’과 같은 **http메세지**를 보냄.
2. **전송계층**에서 **TCP헤더**가 붙음. 출발지 포트 번호(랜덤 포트 중 하나 무작위로 부여됨)와 목적지 포트 번호를 포함.  **세그먼트**로 만듬.
3. **네트워크 계층**에서 IP헤더(출발지 IP주소, 목적지 IP주소)를 붙여서 **패킷**을 만듬
4. **데이터링크** 계층에서 이더넷 헤더(MAC주소)와 트레일러(called FCS)가 붙어 **프레임**이 됨.

5. **물리 계층**에서 랜카드가 데이터(비트)를 **전기 신호**로 변환하여 네트워크로 전송. 랜카드는 어디있는거지?

![장치별네트워크계층](/assets/images/wils/device-network_layer.png)

### 랜 카드에서의 데이터 전달과 처리
기
1. **컴퓨터**는 이더넷 헤더에 컴퓨터의 MAC주소에서 출발, A라우터의 MAC주소에 도착정보를 담아 이더넷 프레임을 만들고 전기 신호로 변환후 스위치 A로 전송

### 스위치와 라우터에서의 데이터 전달과 처리

1. **스위치A**는 컴퓨터에서 들어온 데이터를 데이터 링크 계층에서(왜 물리 계층이 아니지?) 데이터를 전기 신호로 변환하여 라우터 A로 전송
2. 라우터는 데이터 링크 계층에서 전기 신호를 이더넷 프레임으로 변환하고, 목적지 MAC주소(라우터 주소)와 자신의 MAC주소를 비교. 
3. 이때 주소가 같으면 이더넷 헤더와 트레일러 역캡슐화. 네트워크 계층에 전달. 자신의 라우팅 테이블과 목적지 IP주소를 비교해서 최적 경로를 찾음.
4. 출발지 IP주소(192.168.1.*)을 라우터의 외부 주소(WAN측)로 변경후 데이터링크 계층으로 전달. 라우터의 MAC주소 출발 , 라우터B의 MAC주소 도착정보를 담아  이더넷 프레임 만들고 물리 계층으로 전달.
5. 물리 계층에서 데이터를 전기 신호로 변환하여 네트워크로 라우터B에게 전달.
6. **라우터 B**는 이더넷 프레임의 목적지 MAC주소와 자신의 MAC주소를 비교, 주소가 같으면 이더넷 헤더와 트레일러를 분리하는 역캡슐화 후 네트워크 계층으로 전달.

### 웹 서버에서의 데이터 전달과 처리

1. 네트워크계층에서 자신의 라우팅 테이블에서 목적지IP주소를 확인. 라우팅 후 IP주소를 라우터 B에서 출발, 웹서버에 도착 정보를 담아 IP 패킷을 만든 후 데이터 링크 계층에 전달.
2. 전기신호가 **웹 서버**에 도착하면 웹 서버는 데이터 링크 계층에서 이더넷 프레임의 목적지 MAC주소와 자신의 MAC주소를 비교후 같으면 역직렬화후 네트워크 계층에 전달.
3. 전송 계층에서는 목적지 포트 번호를 확인하여 어떤 어플리케이션으로 전달해야 되는지 판단하고, TCP헤더를 분리후 응용계층에 전달.
### 정적 라우팅과  동적 라우팅

- 정적 라우팅은 **관리자**가 미리 라우팅 테이블에 경로를 수동으로 추가. 목적지까지의 경로를 고정하거나, 목적지까지 경로가 하나로 한정되는 경우에 사용.라우팅 정보가 교환되지 않아 **대역폭**에 대한 부담이 적고, **보안**이 좋음. 단점은 장애가 발생해도 다른 경로로 **우회**할 수 없음. 소규모 네트워크에서 사용.
- 동적 라우팅은 네트워크 변경을 **자동**으로 감지하여 라우팅 테이블을 업데이트 하거나, 네트워크 장애가 발생했을때 라우터끼리 정보를 교환하여 최적의 경로로 전환하는 기능. 대규모 네트워크에서 사용.

### 추가

- 헤더는 데이터의 내용과 성격을 식별 또는 제어한다.
- 트레일러는 데이터의 무결성을 보장한다.